(ns saegeblatt.characters)

(def characters {
 \T [
 [0 1 1 1 1 1 0 0]
 [0 0 0 1 0 0 0 0] 
 [0 0 0 1 0 0 0 0]
 [0 0 0 1 0 0 0 0]
 [0 0 0 1 0 0 0 0]
 [0 0 0 1 0 0 0 0]
 [0 0 0 1 0 0 0 0]
 [0 0 0 1 0 0 0 0]
 ]

 \H [
 [0 1 0 0 0 1 0 0]
 [0 1 0 0 0 1 0 0]
 [0 1 0 0 0 1 0 0]
 [0 1 1 1 1 1 0 0]
 [0 1 0 0 0 1 0 0]
 [0 1 0 0 0 1 0 0]
 [0 1 0 0 0 1 0 0]
 [0 1 0 0 0 1 0 0]
 ]

 \A [
 [0 1 1 1 1 1 0 0]
 [0 1 0 0 0 1 0 0]
 [0 1 0 0 0 1 0 0]
 [0 1 1 1 1 1 0 0]
 [0 1 0 0 0 1 0 0]
 [0 1 0 0 0 1 0 0]
 [0 1 0 0 0 1 0 0]
 [0 1 0 0 0 1 0 0]
 ]

 \N [
 [0 1 0 0 0 1 0 0]
 [0 1 1 0 0 1 0 0] 
 [0 1 1 0 0 1 0 0]
 [0 1 0 1 0 1 0 0]
 [0 1 0 0 1 1 0 0]
 [0 1 0 0 1 1 0 0]
 [0 1 0 0 0 1 0 0]
 [0 1 0 0 0 1 0 0]
 ]

 \K [
 [0 1 0 0 0 1 0 0]
 [0 1 0 0 1 0 0 0] 
 [0 1 0 1 0 0 0 0]
 [0 1 1 0 0 0 0 0]
 [0 1 0 1 0 0 0 0]
 [0 1 0 1 0 0 0 0]
 [0 1 0 0 1 0 0 0]
 [0 1 0 0 0 1 0 0]
 ]

 \O [
 [0 1 1 1 1 1 1 0]
 [0 1 0 0 0 0 1 0] 
 [0 1 0 0 0 0 1 0]
 [0 1 0 0 0 0 1 0]
 [0 1 0 0 0 0 1 0]
 [0 1 0 0 0 0 1 0]
 [0 1 0 0 0 0 1 0]
 [0 1 1 1 1 1 1 0]
 ]

 \F [
 [0 1 1 1 1 1 1 0]
 [0 1 0 0 0 0 0 0] 
 [0 1 0 0 0 0 0 0]
 [0 1 1 1 1 1 0 0]
 [0 1 0 0 0 0 0 0]
 [0 1 0 0 0 0 0 0]
 [0 1 0 0 0 0 0 0]
 [0 1 0 0 0 0 0 0]
 ]

 \D [
 [0 1 1 1 1 0 0 0]
 [0 1 0 0 0 1 0 0] 
 [0 1 0 0 0 0 1 0]
 [0 1 0 0 0 0 1 0]
 [0 1 0 0 0 0 1 0]
 [0 1 0 0 0 0 1 0]
 [0 1 0 0 0 1 0 0]
 [0 1 1 1 1 0 0 0]
 ]

 \S [
 [0 1 1 1 1 1 1 0]
 [0 1 0 0 0 0 0 0] 
 [0 1 0 0 0 0 0 0]
 [0 1 0 0 0 0 0 0]
 [0 1 1 1 1 1 0 0]
 [0 0 0 0 0 1 1 0]
 [0 0 0 0 0 1 1 0]
 [0 1 1 1 1 1 0 0]
 ]

 \U [
 [0 1 0 0 0 0 1 0]
 [0 1 0 0 0 0 1 0] 
 [0 1 0 0 0 0 1 0]
 [0 1 0 0 0 0 1 0]
 [0 1 0 0 0 0 1 0]
 [0 1 0 0 0 0 1 0]
 [0 1 0 0 0 0 1 0]
 [0 1 1 1 1 1 1 0]
 ]

 \G [
 [0 1 1 1 1 1 1 0]
 [0 1 0 0 0 0 0 0] 
 [0 1 0 0 0 0 0 0]
 [0 1 1 1 1 1 1 0]
 [0 1 0 0 0 0 1 0]
 [0 1 0 0 0 0 1 0]
 [0 1 0 0 0 0 1 0]
 [0 1 1 1 1 1 1 0]
 ]

 \Y [
 [0 1 0 0 0 1 0 0]
 [0 1 0 0 0 1 0 0] 
 [0 1 0 0 0 1 0 0]
 [0 1 1 1 1 1 0 0]
 [0 0 0 1 0 0 0 0]
 [0 0 0 1 0 0 0 0]
 [0 0 0 1 0 0 0 0]
 [0 0 0 1 0 0 0 0]
 ]

 \' [
 [0 0 0 1 0 0 0 0]
 [0 0 0 1 0 0 0 0] 
 [0 0 0 1 0 0 0 0]
 [0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0]
 ]

 \I [
 [0 1 0 0 0 0 0 0]
 [0 1 0 0 0 0 0 0] 
 [0 1 0 0 0 0 0 0]
 [0 1 0 0 0 0 0 0]
 [0 1 0 0 0 0 0 0]
 [0 1 0 0 0 0 0 0]
 [0 1 0 0 0 0 0 0]
 [0 1 0 0 0 0 0 0]
 ]

 \R [
 [0 1 1 1 1 1 1 0]
 [0 1 0 0 0 0 1 0] 
 [0 1 0 0 0 0 1 0]
 [0 1 1 1 1 1 1 0]
 [0 1 0 1 0 0 0 0]
 [0 1 0 0 1 0 0 0]
 [0 1 0 0 0 1 0 0]
 [0 1 0 0 0 0 1 0]
 ]

 \space  [
 [0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0] 
 [0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 0]
 ]

})

  
(defn transpose
  "Switches rows and columns"
  [char-matrix]
  (apply map vector char-matrix))

(defn byte-value
  [vec]
  (.byteValue
    (apply + (map (fn [v pos] (bit-shift-left v pos)) vec (range 0 8)))))

(defn to-bytes
  [char-matrix]
  (map #(repeat 2 %) (map byte-value (transpose char-matrix))))

(defn string-to-bytes
  [text]
  (vec (flatten (map to-bytes (map characters text)))))


(defn rotate
  ([s] (rotate s 0))
  ([s idx]
     (lazy-seq (cons (nth s (mod idx (count s))) (rotate s (inc idx))))))


